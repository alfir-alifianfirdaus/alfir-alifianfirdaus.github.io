<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bayou & Rani Wedding</title>

    <!-- Preconnect Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Sacramento&family=Tangerine:wght@400;700&family=Cormorant:ital,wght@0,300..700;1,300..700&family=Poppins:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="style.css" />

    <!-- Scroll Smooth -->
    <style>
      html {
        scroll-behavior: smooth;
      }
    </style>
  </head>

  <body>
    <section id="hero" class="hero">
      <div class="hero-container">
        <h2>The Wedding</h2>
        <h1>Bayou & Rani</h1>
        <p>dua jiwa berbeda mengikat janji suci bersatu dalam cinta</p>
        <h4>Kepada Yth. <br />Bapak/Ibu/Saudara/i</h4>
        <a href="#main" class="btn" aria-label="Buka undangan pernikahan"
          >Buka Undangan</a
        >
      </div>
    </section>

    <main id="main">
      <section class="ayat-section">
        <p>
          "Dan di antara tanda-tanda kebesaran-Nya (Allah) ialah Dia menciptakan
          pasangan-pasangan untukmu dari jenismu sendiri, agar kamu cenderung
          dan merasa tentram kepadanya, dan Dia menjadikan di antaramu rasa
          kasih dan sayang. Sungguh, pada yang demikian itu benar-benar terdapat
          tanda-tanda (kebesaran) Allah bagi kaum yang berpikir."
        </p>
        <h5>QS Ar-Rum : 21</h5>
      </section>

      <section class="info-section">
        <h5>Assalamu'alaikum Warahmatullahi Wabarakatuh</h5>
        <p>
          Dengan memohon Rahmat dan Ridho Allah SWT, kami bermaksud untuk
          mengundang Bapak/Ibu/Saudara/i menghadiri acara pernikahan kami:
        </p>

        <div class="nama">
          <h3>Ahmad Bayou Damara, S.T.</h3>
          <p>Putra Pertama dari <br />Bapak H. Ahmad dan Ibu Hj. Siti</p>
          <span class="ampersand">&</span>
          <h3>drg. Silvia Rani Anggraini</h3>
          <p>Putri Pertama dari <br />Bapak H. Budi dan Ibu Hj. Ani</p>
        </div>

        <div class="acara">
          <article class="akad">
            <h4>AKAD NIKAH</h4>
            <p><span>Hari/Tanggal:</span><br />Sabtu, 25 November 2023</p>
            <p><span>Waktu:</span><br />Pukul 09.00 WIB</p>
            <p>
              <span>Tempat:</span><br />Masjid Nasional Al-Akbar Surabaya, Jl.
              Pagesangan No. 1, Surabaya
            </p>
            <a
              href="https://maps.app.goo.gl/tjJqCvX2QzNzRWc1A"
              class="map"
              target="_blank"
              >Lokasi Akad</a
            >
          </article>

          <article class="resepsi">
            <h4>RESEPSI</h4>
            <p><span>Hari/Tanggal:</span><br />Sabtu, 25 November 2023</p>
            <p><span>Waktu:</span><br />Pukul 12.00 - 16.00 WIB</p>
            <p>
              <span>Tempat:</span><br />Gedung Serbaguna Masjid Al-Akbar, Jl.
              Pagesangan No.1, Surabaya
            </p>
            <a
              href="https://maps.app.goo.gl/tjJqCvX2QzNzRWc1A"
              class="map"
              target="_blank"
              >Lokasi Resepsi</a
            >
          </article>
        </div>
      </section>

      <section class="closing-section">
        <p>
          Kami sangat berharap kehadiran Bapak/Ibu/Saudara/i untuk memberikan
          doa restu kepada kami. Atas kehadiran dan doa restunya, kami ucapkan
          terima kasih.
        </p>
        <h5>Wassalamu'alaikum Warahmatullahi Wabarakatuh</h5>
      </section>

      <section class="gallery-section">
        <h2>Galeri</h2>
        <div class="galeri-container">
          <img
            src="image/hiroback.jpg"
            class="foto"
            alt="Bayou & Rani - Galeri 1"
          />
          <img
            src="image/hiroback.jpg"
            class="foto"
            alt="Bayou & Rani - Galeri 2"
          />
          <img
            src="image/hiroback.jpg"
            class="foto"
            alt="Bayou & Rani - Galeri 3"
          />
          <img
            src="image/hiroback.jpg"
            class="foto"
            alt="Bayou & Rani - Galeri 4"
          />
        </div>
      </section>

      <section class="comments-section">
        <h2>Ucapan & Doa</h2>
        <p>
          Silakan tinggalkan ucapan untuk kedua mempelai tanpa perlu login akun
          apa pun.
        </p>
        <form id="comment-form">
          <input type="text" name="nama" placeholder="Nama Anda" required />
          <textarea
            name="komentar"
            rows="4"
            placeholder="Ucapan & Doa"
            required
          ></textarea>
          <button type="submit">Kirim</button>
        </form>

        <h3>Ucapan yang Masuk</h3>
        <div id="comments-list">
          <!-- Komentar akan ditampilkan di sini -->
        </div>
      </section>
    </main>

    <footer>
      <div class="footer-container">
        <p>&copy; 2023 Bayou & Rani Wedding. All rights reserved.</p>
        <span
          >Designed by
          <a href="https://instagram.com/alfir.card" target="_blank"
            >AlFir-Card</a
          ></span
        >
      </div>
    </footer>

    <!-- Script untuk Komentar via Google Sheets -->
    <script>
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbwLgsretbK89b0TgZClxzE_yZt3fDotsETj75-KFbdXjAmD1X5I9zgKyDmM41v5wAv3/exec";
      const form = document.getElementById("comment-form");
      const list = document.getElementById("comments-list");

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const data = new FormData(form);

        fetch(scriptURL, { method: "POST", body: data })
          .then((response) => {
            alert("Terima kasih atas ucapan Anda!");
            form.reset();
            loadComments();
          })
          .catch((error) => alert("Gagal mengirim ucapan. Coba lagi."));
      });

      async function loadComments() {
        const sheetURL =
          "https://docs.google.com/spreadsheets/d/1Uq4q7ry5nETqQkVcDUx_hAUO21fj5K1VKNvhHodmYC8/gviz/tq?tqx=out:json";
        const res = await fetch(sheetURL);
        const text = await res.text();
        const json = JSON.parse(text.substring(47).slice(0, -2));

        list.innerHTML = "";
        json.table.rows.reverse().forEach((row) => {
          const nama = row.c[0]?.v;
          const komentar = row.c[1]?.v;
          const tanggal = row.c[2]?.v;

          // Lewati komentar kosong atau dummy header
          if (!nama || nama.toLowerCase() === "nama") return;
          if (!komentar || komentar.toLowerCase() === "komentar") return;
          if (!tanggal || tanggal.toLowerCase() === "tanggal") return;

          const el = document.createElement("div");
          el.className = "single-comment";
          el.innerHTML = `
          <div class="comment-author">${nama}</div>
          <div class="comment-text">${komentar}</div>
          <div class="comment-date">${tanggal}</div>
        `;
          list.appendChild(el);
        });
      }

      window.addEventListener("DOMContentLoaded", loadComments);
    </script>
  </body>
</html>
